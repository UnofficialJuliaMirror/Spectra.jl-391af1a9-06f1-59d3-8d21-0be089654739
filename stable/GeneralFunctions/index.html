
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Julia library to help treating spectroscopic data.">
      
      
      
        <meta name="author" content="Charles Le Losq">
      
      
        <link rel="shortcut icon" href="../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.7.1">
    
    
      
        <title>General Functions - Spectra.jl</title>
      
    
    
      <script src="../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-f98ca285f9.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-8817cfa535.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../assets/Documenter.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="indigo" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href=".." title="Spectra.jl" class="md-icon md-icon--home md-header-nav__button">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
            
            General Functions
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="md-header-nav__source">
          
            


  


  <a href="https://github.com/charlesll/Spectra.jl" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          
        </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-icon md-icon--home md-nav__button"></i>
    
    Spectra.jl
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/charlesll/Spectra.jl" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../PreProcessing/" title="Pre-Processing" class="md-nav__link">
      Pre-Processing
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        General Functions
      </label>
    
    <a href="./" title="General Functions" class="md-nav__link md-nav__link--active">
      General Functions
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#peak-shapes" title="Peak shapes" class="md-nav__link">
    Peak shapes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#peak-measurement" title="Peak measurement" class="md-nav__link">
    Peak measurement
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration" title="Integration" class="md-nav__link">
    Integration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polynomials" title="Polynomials" class="md-nav__link">
    Polynomials
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splines" title="Splines" class="md-nav__link">
    Splines
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Rameau/" title="Rameau" class="md-nav__link">
      Rameau
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../MLregressor/" title="Machine Learning Regression" class="md-nav__link">
      Machine Learning Regression
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../PeakFitting/" title="Peak Fitting" class="md-nav__link">
      Peak Fitting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Tutorial/" title="Tutorial" class="md-nav__link">
      Tutorial
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Tips/" title="Tips" class="md-nav__link">
      Tips
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../ToDo/" title="Todo" class="md-nav__link">
      Todo
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../References/" title="References" class="md-nav__link">
      References
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#peak-shapes" title="Peak shapes" class="md-nav__link">
    Peak shapes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#peak-measurement" title="Peak measurement" class="md-nav__link">
    Peak measurement
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration" title="Integration" class="md-nav__link">
    Integration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polynomials" title="Polynomials" class="md-nav__link">
    Polynomials
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splines" title="Splines" class="md-nav__link">
    Splines
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/charlesll/Spectra.jl/edit/master/docs/GeneralFunctions.md" title="Edit this page" class="md-icon md-content__icon">edit</a>
                
                
                <p><a id='General-Functions-1'></a></p>
<h1 id="general-functions">General Functions</h1>
<p><a id='Peak-shapes-1'></a></p>
<h2 id="peak-shapes">Peak shapes</h2>
<p>The following functions are useful when generating peaks with various shapes. See the examples for using them during peak fitting for instance.</p>
<p><a id='Spectra.gaussiennes-Tuple{Array{Float64,N},Array{Float64,N},Array{Float64,N},Array{Float64,N}}' href='#Spectra.gaussiennes-Tuple{Array{Float64,N},Array{Float64,N},Array{Float64,N},Array{Float64,N}}'>#</a>
<strong><code>Spectra.gaussiennes</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span><span class="nt">gaussiennes</span><span class="o">(</span><span class="nt">amplitude</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">centre</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">hwhm</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">x</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">;</span><span class="nt">style</span><span class="p">::</span><span class="nd">String</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span><span class="o">)</span>
</pre></div>


<p>gaussiennes, written in the plural french form there, is a function that allows to build gaussian peaks. The gaussian function used there is:</p>
<div class="codehilite"><pre><span></span>y = amplitude x exp(-ln(2) x [(x-centre)/hwhm]^2 )

You can enter the amplitude, centre and half-width at half-maximum (hwhm) values as arrays of float 64 (even containing one float value), without specifying style. hwhm is proportional to the standard deviation sigma:

hwhm= sqrt(2xln(2)) x sigma
</pre></div>


<p>that is used in a normal distribution (see function normal_dist).</p>
<p>INPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">amplitude</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">peaks</span> <span class="n">amplitudes</span><span class="o">;</span>

<span class="n">centre</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">peaks</span> <span class="n">centres</span><span class="o">;</span>

<span class="n">hwhm</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">peaks</span> <span class="n">half</span><span class="o">-</span><span class="n">width</span> <span class="n">at</span> <span class="n">middle</span> <span class="n">heights</span> <span class="o">(</span><span class="n">hwhm</span><span class="o">);</span>

<span class="n">x</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">x</span> <span class="n">axis</span> <span class="n">values</span><span class="o">;</span>
</pre></div>


<p>OPTIONS:</p>
<div class="codehilite"><pre><span></span><span class="n">style</span><span class="o">:</span> <span class="n">ASCIIString</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span><span class="o">,</span> <span class="n">see</span> <span class="n">examples</span> <span class="n">below</span><span class="o">.</span>
</pre></div>


<p>OUTPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">y_calc</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">calculated</span> <span class="n">y</span> <span class="n">values</span><span class="o">;</span>

<span class="n">y_peaks</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">y</span> <span class="n">values</span> <span class="n">of</span> <span class="n">the</span> <span class="n">different</span> <span class="n">peaks</span><span class="o">.</span>
</pre></div>


<hr />
<p><strong>Examples</strong></p>
<p>To have four gaussian peaks centered at 800, 900, 1000 and 1100 cm-1 with hwhm of 50 cm-1 on a Raman spectrum, you will enter:</p>
<p>y_calc, y_peaks = gaussiennes([1.0,1.0,1.0,1.0], [800.0,900.0,1000.0,1100.0], [50.0,50.0,50.0,50.0], x)</p>
<p>and y_peaks will contain in 4 columns the 4 different y values of the peaks, and y_calc their sum (the total model). Now, if you want to calculate more complex models, such as for instance contructing how the Raman peaks of water vary with pressure, you might like to parametrize the variations of the peak parameters rather than just fitting each spectrum. This will provide more robust fits of the spectra, as you will fit them together, and will also force you to find the correct underlying mathematical assumption.</p>
<p>The gaussiennes function allows you to do that. If you specify style = "poly", you can enter arrays for the amplitudes, centres and half-widths at half-maximum (hwhm) of the peaks, with in each column the coefficients for the polynomial variations of this parameters. The second column of x will need to contain the second variable for those polynomial functions.</p>
<p>Let's say for instance that we have one peak at 900 cm-1 in a pure material. It's frequency seems to linearly shift with increasing the amount of hydrogen in this material, but it's intensity is non-linearly increasing, following a quadratic variation. It's width seems constant.</p>
<p>How to write that with gaussiennes? Well, first you need to construct a relevant x axis: first column contains the frequency, and the second one contains the chemical variable value. In our case, we want to model the peak between 800 and 1000 cm-1, for 1 wt% H. So we have an x array build like:</p>
<div class="codehilite"><pre><span></span>frequency = collect(800:1:1000)

x = ones(length(frequency),2)

x[:,1] = frequency[:]

x[:,2] = 1.0
</pre></div>


<p>Ok, now lets build our y peaks:</p>
<div class="codehilite"><pre><span></span>amplitudes = [1.0 0.1 0.1]

frequencies = [900.0 2.0]

hwhm = 20.0

y_calc, y_peaks = gaussiennes(amplitudes, frequencies, hwhm, x)
</pre></div>


<p>This should provide you how the shape of the peak is as a function of both the frequency and the chemical composition there. If you want to go further, you might just want to stick gaussiennes in a loop, and play with creating various peaks with changing the chemical parameter in the x[:,2] column!</p>
<p><a target='_blank' href='https://github.com/charlesll/Spectra.jl/tree/d80b712b23fc20c7e8ff0cbf97de5d1b304ce6e1/src/functions.jl#L63-L131' class='documenter-source'>source</a><br></p>
<p><a id='Spectra.lorentziennes-Tuple{Array{Float64,N},Array{Float64,N},Array{Float64,N},Array{Float64,N}}' href='#Spectra.lorentziennes-Tuple{Array{Float64,N},Array{Float64,N},Array{Float64,N},Array{Float64,N}}'>#</a>
<strong><code>Spectra.lorentziennes</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span><span class="nt">lorentziennes</span><span class="o">(</span><span class="nt">amplitude</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">centre</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">hwhm</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">x</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">;</span><span class="nt">style</span><span class="p">::</span><span class="nd">String</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span><span class="o">)</span>
</pre></div>


<p>INPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">amplitude</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">peaks</span> <span class="n">amplitudes</span><span class="o">;</span>

<span class="n">centre</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">peaks</span> <span class="n">centres</span><span class="o">;</span>

<span class="n">hwhm</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">peaks</span> <span class="n">half</span><span class="o">-</span><span class="n">width</span> <span class="n">at</span> <span class="n">middle</span> <span class="n">heights</span> <span class="o">(</span><span class="n">hwhm</span><span class="o">);</span>

<span class="n">x</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">x</span> <span class="n">axis</span> <span class="n">values</span><span class="o">;</span>
</pre></div>


<p>OPTIONS:</p>
<div class="codehilite"><pre><span></span><span class="n">style</span><span class="o">:</span> <span class="n">ASCIIString</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span><span class="o">,</span> <span class="n">see</span> <span class="n">examples</span> <span class="k">in</span> <span class="n">the</span> <span class="n">gaussiennes</span> <span class="n">documentation</span><span class="o">.</span>
</pre></div>


<p>OUTPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">y_calc</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">calculated</span> <span class="n">y</span> <span class="n">values</span><span class="o">;</span>

<span class="n">y_peaks</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">y</span> <span class="n">values</span> <span class="n">of</span> <span class="n">the</span> <span class="n">different</span> <span class="n">peaks</span><span class="o">.</span>
</pre></div>


<p><a target='_blank' href='https://github.com/charlesll/Spectra.jl/tree/d80b712b23fc20c7e8ff0cbf97de5d1b304ce6e1/src/functions.jl#L148-L172' class='documenter-source'>source</a><br></p>
<p><a id='Spectra.pearson7-Tuple{Array{Float64,N},Array{Float64,N},Array{Float64,N},Array{Float64,N},Array{Float64,N}}' href='#Spectra.pearson7-Tuple{Array{Float64,N},Array{Float64,N},Array{Float64,N},Array{Float64,N},Array{Float64,N}}'>#</a>
<strong><code>Spectra.pearson7</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span><span class="nt">pearson7</span><span class="o">(</span><span class="nt">a1</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">a2</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">a3</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">a4</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">x</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">;</span><span class="nt">style</span><span class="p">::</span><span class="nd">String</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span><span class="o">)</span>
</pre></div>


<p>a Pearson 7 peak with formula a1 ./ (1 + ((x-a2)./a3).^2 .* (2.0.^(1./a4) - 1.0))</p>
<p>INPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">a1</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="o">;</span>

<span class="n">a2</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="o">;</span>

<span class="n">a3</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="o">;</span>

<span class="n">a4</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="o">;</span>

<span class="n">x</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">x</span> <span class="n">axis</span> <span class="n">values</span><span class="o">;</span>
</pre></div>


<p>OPTIONS:</p>
<div class="codehilite"><pre><span></span><span class="n">style</span><span class="o">:</span> <span class="n">ASCIIString</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span><span class="o">,</span> <span class="n">see</span> <span class="n">examples</span> <span class="k">in</span> <span class="n">the</span> <span class="n">gaussiennes</span> <span class="n">documentation</span><span class="o">.</span>
</pre></div>


<p>OUTPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">y_calc</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">calculated</span> <span class="n">y</span> <span class="n">values</span><span class="o">;</span>

<span class="n">y_peaks</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">y</span> <span class="n">values</span> <span class="n">of</span> <span class="n">the</span> <span class="n">different</span> <span class="n">peaks</span><span class="o">.</span>
</pre></div>


<p><a target='_blank' href='https://github.com/charlesll/Spectra.jl/tree/d80b712b23fc20c7e8ff0cbf97de5d1b304ce6e1/src/functions.jl#L190-L217' class='documenter-source'>source</a><br></p>
<p><a id='Spectra.pseudovoigts-Tuple{Array{Float64,N},Array{Float64,N},Array{Float64,N},Array{Float64,N},Array{Float64,N}}' href='#Spectra.pseudovoigts-Tuple{Array{Float64,N},Array{Float64,N},Array{Float64,N},Array{Float64,N},Array{Float64,N}}'>#</a>
<strong><code>Spectra.pseudovoigts</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span><span class="nt">pseudovoigts</span><span class="o">(</span><span class="nt">amplitude</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">centre</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">hwhm</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">lorentzian_fraction</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">x</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">;</span><span class="nt">style</span><span class="p">::</span><span class="nd">String</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span><span class="o">)</span>
</pre></div>


<p>A mixture of gaussian and lorentzian peaks.</p>
<p>INPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">amplitude</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">peaks</span> <span class="n">amplitudes</span><span class="o">;</span>

<span class="n">centre</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">peaks</span> <span class="n">centres</span><span class="o">;</span>

<span class="n">hwhm</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">peaks</span> <span class="n">half</span><span class="o">-</span><span class="n">width</span> <span class="n">at</span> <span class="n">middle</span> <span class="n">heights</span> <span class="o">(</span><span class="n">hwhm</span><span class="o">);</span>

<span class="n">lorentzian_fraction</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">lorentzian</span> <span class="n">fraction</span> <span class="n">of</span> <span class="n">the</span> <span class="n">pseudovoigt</span> <span class="kd">function</span><span class="o">.</span> <span class="n">Should</span> <span class="n">be</span> <span class="n">comprised</span> <span class="n">between</span> <span class="mi">0</span> <span class="n">and</span> <span class="mi">1</span><span class="o">;</span> 

<span class="n">x</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">x</span> <span class="n">axis</span> <span class="n">values</span><span class="o">;</span>
</pre></div>


<p>OPTIONS:</p>
<div class="codehilite"><pre><span></span><span class="n">style</span><span class="o">:</span> <span class="n">ASCIIString</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span><span class="o">,</span> <span class="n">see</span> <span class="n">examples</span> <span class="k">in</span> <span class="n">the</span> <span class="n">gaussiennes</span> <span class="n">documentation</span><span class="o">.</span>
</pre></div>


<p>OUTPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">y_calc</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">calculated</span> <span class="n">y</span> <span class="n">values</span><span class="o">;</span>

<span class="n">y_peaks</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">y</span> <span class="n">values</span> <span class="n">of</span> <span class="n">the</span> <span class="n">different</span> <span class="n">peaks</span><span class="o">.</span>
</pre></div>


<p><a target='_blank' href='https://github.com/charlesll/Spectra.jl/tree/d80b712b23fc20c7e8ff0cbf97de5d1b304ce6e1/src/functions.jl#L235-L262' class='documenter-source'>source</a><br></p>
<p><a id='Spectra.normal_dist-Tuple{Array{Float64,N},Array{Float64,N},Array{Float64,N},Array{Float64,N}}' href='#Spectra.normal_dist-Tuple{Array{Float64,N},Array{Float64,N},Array{Float64,N},Array{Float64,N}}'>#</a>
<strong><code>Spectra.normal_dist</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>normal_dist(nd_amplitudes::Array{Float64},nd_centres::Array{Float64},nd_sigmas::Array{Float64},x::Array{Float64})
</pre></div>


<p>The real normal distribution / gaussian function</p>
<p>INPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">amplitude</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">peaks</span> <span class="n">amplitudes</span><span class="o">;</span>

<span class="n">centre</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">peaks</span> <span class="n">centres</span><span class="o">;</span>

<span class="n">hwhm</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">peaks</span> <span class="n">half</span><span class="o">-</span><span class="n">width</span> <span class="n">at</span> <span class="n">middle</span> <span class="n">heights</span> <span class="o">(</span><span class="n">hwhm</span><span class="o">);</span>

<span class="n">lorentzian_fraction</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">lorentzian</span> <span class="n">fraction</span> <span class="n">of</span> <span class="n">the</span> <span class="n">pseudovoigt</span> <span class="kd">function</span><span class="o">.</span> <span class="n">Should</span> <span class="n">be</span> <span class="n">comprised</span> <span class="n">between</span> <span class="mi">0</span> <span class="n">and</span> <span class="mi">1</span><span class="o">;</span> 

<span class="n">x</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">x</span> <span class="n">axis</span> <span class="n">values</span><span class="o">;</span>
</pre></div>


<p>OPTIONS:</p>
<div class="codehilite"><pre><span></span><span class="n">style</span><span class="o">:</span> <span class="n">ASCIIString</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span><span class="o">,</span> <span class="n">see</span> <span class="n">examples</span> <span class="k">in</span> <span class="n">the</span> <span class="n">gaussiennes</span> <span class="n">documentation</span><span class="o">.</span>
</pre></div>


<p>OUTPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">y_calc</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">calculated</span> <span class="n">y</span> <span class="n">values</span><span class="o">;</span>

<span class="n">y_peaks</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">y</span> <span class="n">values</span> <span class="n">of</span> <span class="n">the</span> <span class="n">different</span> <span class="n">peaks</span><span class="o">.</span>
</pre></div>


<p><a target='_blank' href='https://github.com/charlesll/Spectra.jl/tree/d80b712b23fc20c7e8ff0cbf97de5d1b304ce6e1/src/functions.jl#L285-L312' class='documenter-source'>source</a><br></p>
<p><a id='Peak-measurement-1'></a></p>
<h2 id="peak-measurement">Peak measurement</h2>
<p><a id='Spectra.peakmeas-Tuple{Array{Float64,N},Array{Float64,N}}' href='#Spectra.peakmeas-Tuple{Array{Float64,N},Array{Float64,N}}'>#</a>
<strong><code>Spectra.peakmeas</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span><span class="nt">peakmeas</span><span class="o">(</span><span class="nt">x</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">y</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">;</span><span class="nt">smoothing</span> <span class="o">=</span> <span class="s2">&quot;yes&quot;</span><span class="o">,</span> <span class="nt">filter</span> <span class="o">=</span> <span class="p">:</span><span class="nd">SavitzkyGolay</span><span class="o">,</span> <span class="nt">M</span><span class="o">=</span><span class="nt">5</span><span class="o">,</span><span class="nt">N</span><span class="o">=</span><span class="nt">2</span><span class="o">,</span><span class="nt">ese_y</span><span class="o">=</span><span class="nt">1</span><span class="o">.,</span><span class="nt">y_smo_out</span><span class="o">=</span><span class="nt">false</span><span class="o">)</span>
</pre></div>


<p>The peakmeas function allows performing measurements of the position, width, intensity and centroïd of a dominant peak in a provided x-y signal.</p>
<p>It smooths the signal with a Savitzky-Golay filter prior to measuring the peak position, width and intensity. It is advised to check that the M and N values of the Savitzky-Golay filter are adequate for your problem before trusting the results from peakmeas. For that, just use the y_smo_out option. </p>
<p>half-width at half-maximum are calculated as the width of the peak at half its maximum intensity. This calculation is not affected by any asumption of peak symmetry (no fitting is done).</p>
<p>Centroïd is calculated as sum(y./sum(y).*x).</p>
<p>INPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">x</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">the</span> <span class="n">x</span> <span class="n">values</span><span class="o">;</span>

<span class="n">y</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">the</span> <span class="n">y</span> <span class="n">values</span><span class="o">.</span>
</pre></div>


<p>OPTIONS:</p>
<div class="codehilite"><pre><span></span>smoothing, String, triggers the smoothing of the spectrum if set to yes (default value);

filter, Symbol, the filter that will be used. See the smooth function documentation;

M=5, the M parameter for smoothing y with a Savitzky-Golay filter. See smooth function documentation;

N=2, the M parameter for smoothing y with a Savitzky-Golay filter. See smooth function documentation;

y_smo_out=false, the smoothed signal. Signal will be smoothed if set to true, using the SavitzkyGolayFilter function with the M and N values. y_smo output will also be provided.
</pre></div>


<p>OUTPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">position</span><span class="o">:</span> <span class="n">Float64</span><span class="o">,</span> <span class="n">the</span> <span class="n">position</span> <span class="n">of</span> <span class="n">the</span> <span class="n">peak</span><span class="o">;</span>

<span class="n">hwhm</span><span class="o">:</span> <span class="n">Float64</span><span class="o">,</span> <span class="n">the</span> <span class="n">half</span><span class="o">-</span><span class="n">width</span> <span class="n">at</span> <span class="n">half</span><span class="o">-</span><span class="n">maximum</span> <span class="n">of</span> <span class="n">the</span> <span class="n">peak</span><span class="o">;</span>

<span class="n">intensity</span><span class="o">:</span> <span class="n">Float64</span><span class="o">,</span> <span class="n">the</span> <span class="n">intensity</span> <span class="n">of</span> <span class="n">the</span> <span class="n">peak</span><span class="o">;</span>

<span class="n">centro</span><span class="err">ï</span><span class="n">d</span><span class="o">:</span> <span class="n">Float64</span><span class="o">,</span> <span class="n">the</span> <span class="n">centro</span><span class="err">ï</span><span class="n">d</span> <span class="n">of</span> <span class="n">the</span> <span class="n">peak</span><span class="o">;</span>

<span class="k">if</span> <span class="n">y_smo_out</span> <span class="k">is</span> <span class="kd">set</span> <span class="n">to</span> <span class="kc">true</span><span class="o">,</span> <span class="n">then</span> <span class="n">another</span> <span class="n">output</span> <span class="k">is</span> <span class="n">provided</span><span class="o">:</span>

<span class="n">y_smo</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">the</span> <span class="n">smoothed</span> <span class="n">y</span> <span class="n">signal</span><span class="o">.</span>
</pre></div>


<p><a target='_blank' href='https://github.com/charlesll/Spectra.jl/tree/d80b712b23fc20c7e8ff0cbf97de5d1b304ce6e1/src/peakmeasurement.jl#L17-L59' class='documenter-source'>source</a><br></p>
<p><a id='Integration-1'></a></p>
<h2 id="integration">Integration</h2>
<p>Spectra.jl provides functions that allow one to integrate the area under a region of a spectrum, or to calculate the area under Gaussian, Lorentzian or other bands.</p>
<p><a id='Spectra.trapz-Tuple{Array{Tx<:Number,1},Array{Ty<:Number,1}}' href='#Spectra.trapz-Tuple{Array{Tx<:Number,1},Array{Ty<:Number,1}}'>#</a>
<strong><code>Spectra.trapz</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>trapz{Tx&lt;:Number, Ty&lt;:Number}(x::Vector{Tx}, y::Vector{Ty})
</pre></div>


<p>Trapezoidal integration.</p>
<p>INPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">x</span><span class="o">:</span> <span class="n">Vector</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">x</span> <span class="n">values</span><span class="o">;</span>

<span class="n">y</span><span class="o">:</span> <span class="n">Vector</span><span class="o">{</span><span class="n">Float64</span><span class="o">}</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">y</span> <span class="n">values</span><span class="o">.</span>
</pre></div>


<p>OUTPUTS: </p>
<div class="codehilite"><pre><span></span><span class="n">area</span><span class="o">:</span> <span class="n">Vector</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">the</span> <span class="n">trapezoidal</span> <span class="n">integration</span> <span class="n">value</span><span class="o">.</span>
</pre></div>


<p>This function is particularly helpful to calculate the area under a portion of a spectrum, and can be used for various purposes (normalisation, area comparison, etc.).</p>
<p><a target='_blank' href='https://github.com/charlesll/Spectra.jl/tree/d80b712b23fc20c7e8ff0cbf97de5d1b304ce6e1/src/integrale.jl#L17-L34' class='documenter-source'>source</a><br></p>
<p><a id='Spectra.bandarea-Tuple{Array{Float64,N},Array{Float64,N}}' href='#Spectra.bandarea-Tuple{Array{Float64,N},Array{Float64,N}}'>#</a>
<strong><code>Spectra.bandarea</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span><span class="nt">bandarea</span><span class="o">(</span><span class="nt">Amplitude</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">,</span><span class="nt">HWHM</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span><span class="o">;</span> <span class="nt">peak_shape</span> <span class="o">=</span> <span class="s2">&quot;Gaussian&quot;</span><span class="o">,</span> <span class="nt">error_switch</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span><span class="o">,</span> <span class="nt">eseAmplitude</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span> <span class="o">=</span> <span class="cp">[</span><span class="mf">0.0</span><span class="cp">]</span><span class="o">,</span> <span class="nt">eseHWHM</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Float64</span><span class="p">}</span> <span class="o">=</span> <span class="cp">[</span><span class="mf">0.0</span><span class="cp">]</span><span class="o">)</span>
</pre></div>


<p>This function replaces the function gaussianarea in the version &lt;0.1.9 of Spectra.jl. It allows to calculate the area under a specific band, with different shapes. For now, only Gaussian bands are supported, but other band shapes will be added soon. (This explains why gaussianarea is deprecated in favor of a more generic function)</p>
<p>gaussianarea allows to calculate the area under a gaussian peak from its half-width at half maximum (hwhm) and its amplitude, with the possibility of calculating the error based on the inputs of the errors on hwhm and amplitude. Call it as:</p>
<div class="codehilite"><pre><span></span>area, esearea = band(Amplitude,HWHM; peak_shape = &quot;Gaussian&quot;, error_switch = &quot;no&quot;, eseAmplitude = [0.0], eseHWHM = [0.0])
</pre></div>


<p>INPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">Amplitude</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">contains</span> <span class="n">the</span> <span class="n">amplitudes</span> <span class="o">(</span><span class="n">intensity</span><span class="o">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">band</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>

<span class="n">HWHM</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">contains</span> <span class="n">the</span> <span class="n">half</span> <span class="n">width</span> <span class="n">at</span> <span class="n">half</span> <span class="n">maximum</span> <span class="n">of</span> <span class="n">the</span> <span class="n">peaks</span><span class="o">;</span>
</pre></div>


<p>OPTIONS</p>
<div class="codehilite"><pre><span></span><span class="n">peak_shape</span><span class="o">:</span> <span class="n">String</span><span class="o">,</span> <span class="n">indicates</span> <span class="n">the</span> <span class="n">shape</span> <span class="n">of</span> <span class="n">the</span> <span class="n">component</span><span class="o">.</span> <span class="n">Only</span> <span class="s2">&quot;Gaussian&quot;</span> <span class="k">is</span> <span class="n">supported</span> <span class="k">for</span> <span class="n">now</span><span class="o">;</span>

<span class="n">error_switch</span><span class="o">:</span> <span class="n">String</span><span class="o">,</span> <span class="n">should</span> <span class="n">be</span> <span class="s2">&quot;yes&quot;</span> <span class="n">or</span> <span class="s2">&quot;no&quot;</span><span class="o">.</span> <span class="n">If</span> <span class="s2">&quot;yes&quot;</span><span class="o">,</span> <span class="n">the</span> <span class="n">arrays</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">errors</span> <span class="n">affecting</span> <span class="n">the</span> <span class="n">band</span> <span class="n">amplitude</span> <span class="n">and</span> <span class="n">widhts</span> <span class="n">should</span> <span class="n">be</span> <span class="n">provided</span> <span class="k">in</span> <span class="n">eseAmplitude</span> <span class="n">and</span> <span class="n">eseHWHM</span> <span class="o">(</span><span class="n">see</span> <span class="n">below</span><span class="o">);</span>

<span class="n">eseAmplitude</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">an</span> <span class="n">array</span> <span class="n">that</span> <span class="n">contains</span> <span class="n">the</span> <span class="n">errors</span> <span class="n">affecting</span> <span class="n">Amplitude</span><span class="o">;</span>

<span class="n">eseHWHM</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">an</span> <span class="n">array</span> <span class="n">that</span> <span class="n">contains</span> <span class="n">the</span> <span class="n">errors</span> <span class="n">affecting</span> <span class="n">HWHM</span><span class="o">;</span>
</pre></div>


<p>OUTPUTS: </p>
<div class="codehilite"><pre><span></span><span class="n">area</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">an</span> <span class="n">array</span> <span class="n">that</span> <span class="n">contains</span> <span class="n">the</span> <span class="n">areas</span><span class="o">;</span>

<span class="k">if</span> <span class="n">error_switch</span> <span class="k">is</span> <span class="kd">set</span> <span class="n">to</span> <span class="s2">&quot;yes&quot;</span><span class="o">,</span> <span class="n">then</span> <span class="n">a</span> <span class="n">second</span> <span class="n">output</span> <span class="k">is</span> <span class="n">provided</span><span class="o">:</span>

<span class="n">esearea</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">an</span> <span class="n">array</span> <span class="n">that</span> <span class="n">contains</span> <span class="n">the</span> <span class="n">propagated</span> <span class="n">errors</span> <span class="n">affecting</span> <span class="n">the</span> <span class="n">areas</span> <span class="n">calculations</span><span class="o">.</span>
</pre></div>


<p><a target='_blank' href='https://github.com/charlesll/Spectra.jl/tree/d80b712b23fc20c7e8ff0cbf97de5d1b304ce6e1/src/integrale.jl#L50-L82' class='documenter-source'>source</a><br></p>
<p><a id='Polynomials-1'></a></p>
<h2 id="polynomials">Polynomials</h2>
<p><a id='Spectra.poly-Tuple{Array{Float64,1},Array{Float64,N}}' href='#Spectra.poly-Tuple{Array{Float64,1},Array{Float64,N}}'>#</a>
<strong><code>Spectra.poly</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>poly(p::Vector{Float64},x::Array{Float64})
</pre></div>


<p>This function just allows to build a polynomial curve.</p>
<p>INPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">p</span><span class="o">:</span> <span class="n">Vector</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">polynomial</span> <span class="n">parameters</span><span class="o">.</span> <span class="n">For</span> <span class="n">a</span> <span class="n">linear</span> <span class="n">curve</span><span class="o">,</span> <span class="n">p</span> <span class="o">=</span> <span class="o">[</span><span class="mf">1.0</span><span class="o">,</span><span class="mf">1.0</span><span class="o">],</span> <span class="k">for</span> <span class="n">a</span> <span class="n">second</span> <span class="n">order</span> <span class="n">polynomial</span><span class="o">,</span> <span class="n">p</span> <span class="o">=</span> <span class="o">[</span><span class="mf">1.0</span><span class="o">,</span><span class="mf">1.0</span><span class="o">,</span><span class="mf">1.0</span><span class="o">],</span> <span class="n">etc</span><span class="o">.;</span>

<span class="n">x</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">x</span> <span class="n">values</span> <span class="k">for</span> <span class="n">calculation</span><span class="o">.</span>
</pre></div>


<p>Output:</p>
<div class="codehilite"><pre><span></span><span class="n">y</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">result</span> <span class="n">of</span> <span class="n">calculation</span><span class="o">.</span>
</pre></div>


<p><a target='_blank' href='https://github.com/charlesll/Spectra.jl/tree/d80b712b23fc20c7e8ff0cbf97de5d1b304ce6e1/src/functions.jl#L16-L30' class='documenter-source'>source</a><br></p>
<p><a id='Spectra.polyfit-Tuple{Array{Float64,N},Array{Float64,N},Int64}' href='#Spectra.polyfit-Tuple{Array{Float64,N},Array{Float64,N},Int64}'>#</a>
<strong><code>Spectra.polyfit</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span>polyfit(x::Array{Float64}, y::Array{Float64}, n::Int64)
</pre></div>


<p>Fit a polynom of degree n to x-y data. Code from https://rosettacode.org/wiki/Polynomial_regression#Julia</p>
<p>INPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">x</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">the</span> <span class="n">x</span> <span class="n">values</span><span class="o">;</span>

<span class="n">y</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">the</span> <span class="n">y</span> <span class="n">values</span><span class="o">;</span>

<span class="n">n</span><span class="o">:</span> <span class="n">Int64</span><span class="o">,</span> <span class="n">the</span> <span class="n">polynomial</span> <span class="n">degree</span><span class="o">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">a</span> <span class="n">constant</span> <span class="n">up</span> <span class="n">to</span> <span class="k">as</span> <span class="n">high</span> <span class="k">as</span> <span class="n">wanted</span><span class="o">.</span>
</pre></div>


<p>OUTPUTS:</p>
<div class="codehilite"><pre><span></span><span class="n">coefs</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">containing</span> <span class="n">the</span> <span class="n">polynomial</span> <span class="n">coefficients</span><span class="o">.</span>
</pre></div>


<p><a target='_blank' href='https://github.com/charlesll/Spectra.jl/tree/d80b712b23fc20c7e8ff0cbf97de5d1b304ce6e1/src/functions.jl#L39-L56' class='documenter-source'>source</a><br></p>
<p><a id='Splines-1'></a></p>
<h2 id="splines">Splines</h2>
<p>Not all the splines packages provide the same performances for data smoothing and interpolation. By experience, the Dierckx spline package ("Dspline" option in the baseline() function) provides a good starting point, but is not as usefull as other spline packages.</p>
<p>The csaps function of Matlab uses the SMOOTH Fortran library, and provides better smoothing capabilities for noisy data. Similarly, the GCVSPL Fortran package from Woltring (1986) also provides a very robust way to smooth and interpolate noisy data.</p>
<p>Starting from Spectra v0.3.4, the gcvspline Python module (https://github.com/charlesll/gcvspline) is used in the smooth and baseline function. It behaves exactly as the previous wrapping of GCVSPL.f in Julia, such that this should be transparent to users.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../PreProcessing/" title="Pre-Processing" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Pre-Processing
              </span>
            </div>
          </a>
        
        
          <a href="../Rameau/" title="Rameau" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Rameau
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-e3caa82af6.js"></script>
      
      
      <script>app.initialize({url:{base:".."}})</script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../assets/mathjaxhelper.js"></script>
      
    
    
      
    
  </body>
</html>