<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Charles Le Losq">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Machine Learning Regression - Spectra.jl</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  <link href="../assets/Documenter.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Machine Learning Regression";
    var mkdocs_page_input_path = "MLregressor.md";
    var mkdocs_page_url = "/MLregressor/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Spectra.jl</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Installation/">Installation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../PreProcessing/">Pre-Processing</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../GeneralFunctions/">General Functions</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Rameau/">Rameau</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Machine Learning Regression</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#machine-learning-regression">Machine Learning Regression</a></li>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../PeakFitting/">Peak Fitting</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Tutorial/">Tutorial</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Tips/">Tips</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ToDo/">Todo</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../References/">References</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Spectra.jl</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Machine Learning Regression</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/charlesll/Spectra.jl/edit/master/docs/MLregressor.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><a id='Machine-Learning-Regression-1'></a></p>
<h1 id="machine-learning-regression">Machine Learning Regression</h1>
<p>Spectra offers a basic access to some machine learning algorithms from the SciKit Learn python library. In addition to using them for baseline fitting, you can also use them to predict an output. For instance, if you have several spectra that you pre-processed with Spectra, you can organise them with each spectra as a row of a large array. Each column will be a channel, or also called a feature, that the machine learning algorithms will look at. From this, Spectra allows you to call</p>
<ul>
<li>the Support Vector or Kernel Ridge regression algorithms from SciKit Learn;</li>
</ul>
<div class="codehilite"><pre><span></span>- the Linear Regression algorithm from SciKit Learn.
</pre></div>


<p>With those algorithm, you can predict a y value (for instance, the concentration of a component that seems to affect the spectral shape) that is related to changes in your spectra. This is done with the mlregressor function. A more extensive use of the SciKit Learn algorithms can be done directly with calling SciKit Learn using a PyCall instance.</p>
<p><a id='Spectra.mlregressor-Tuple{Array{Float64,N},Array{Float64,N},AbstractString}' href='#Spectra.mlregressor-Tuple{Array{Float64,N},Array{Float64,N},AbstractString}'>#</a>
<strong><code>Spectra.mlregressor</code></strong> &mdash; <em>Method</em>.</p>
<div class="codehilite"><pre><span></span><span class="kd">function</span> <span class="nx">mlregressor</span><span class="p">(</span><span class="nx">x</span><span class="o">::</span><span class="nb">Array</span><span class="p">{</span><span class="nx">Float64</span><span class="p">},</span><span class="nx">y</span><span class="o">::</span><span class="nb">Array</span><span class="p">{</span><span class="nx">Float64</span><span class="p">},</span><span class="nx">algorithm</span><span class="o">::</span><span class="nx">AbstractString</span><span class="p">;</span><span class="nx">X_test</span><span class="o">::</span><span class="nb">Array</span><span class="p">{</span><span class="nx">Float64</span><span class="p">}</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">],</span><span class="nx">y_test</span><span class="o">::</span><span class="nb">Array</span><span class="p">{</span><span class="nx">Float64</span><span class="p">}</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">],</span><span class="nx">test_sz</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="nx">scaler</span><span class="o">=</span><span class="s2">&quot;MinMaxScaler&quot;</span><span class="p">,</span><span class="nx">rand_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="nx">param_grid_kr</span> <span class="o">=</span> <span class="nx">Dict</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="o">=&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="nx">e1</span><span class="p">,</span> <span class="mi">1</span><span class="nx">e0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">5</span><span class="nx">e</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="nx">e</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="nx">e</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="nx">e</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span><span class="s2">&quot;gamma&quot;</span><span class="o">=&gt;</span> <span class="nx">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span><span class="nx">param_grid_svm</span><span class="o">=</span><span class="nx">Dict</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="o">=&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="nx">e0</span><span class="p">,</span> <span class="mi">2</span><span class="nx">e0</span><span class="p">,</span> <span class="mi">5</span><span class="nx">e0</span><span class="p">,</span> <span class="mi">1</span><span class="nx">e1</span><span class="p">,</span> <span class="mi">5</span><span class="nx">e1</span><span class="p">,</span> <span class="mi">1</span><span class="nx">e2</span><span class="p">,</span> <span class="mi">5</span><span class="nx">e2</span><span class="p">,</span> <span class="mi">1</span><span class="nx">e3</span><span class="p">,</span> <span class="mi">5</span><span class="nx">e3</span><span class="p">,</span> <span class="mi">1</span><span class="nx">e4</span><span class="p">,</span> <span class="mi">5</span><span class="nx">e4</span><span class="p">,</span> <span class="mi">1</span><span class="nx">e5</span><span class="p">],</span><span class="s2">&quot;gamma&quot;</span><span class="o">=&gt;</span> <span class="nx">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span><span class="nx">user_kernel</span><span class="o">=</span><span class="s2">&quot;rbf&quot;</span><span class="p">)</span>
</pre></div>


<p>Working on that, please be careful when using it.   </p>
<p>INPUTS</p>
<div class="codehilite"><pre><span></span><span class="n">x</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">the</span> <span class="n">spectra</span> <span class="n">organised</span> <span class="k">in</span> <span class="n">rows</span> <span class="o">(</span><span class="mi">1</span> <span class="n">row</span> <span class="o">=</span> <span class="n">one</span> <span class="n">spectrum</span><span class="o">).</span> <span class="n">The</span> <span class="n">spectra</span> <span class="n">should</span> <span class="n">share</span> <span class="n">a</span> <span class="n">common</span> <span class="n">X</span> <span class="n">axis</span><span class="o">;</span>

<span class="n">y</span><span class="o">::</span><span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">the</span> <span class="n">target</span><span class="o">.</span> <span class="n">Only</span> <span class="n">a</span> <span class="n">sigle</span> <span class="n">target</span> <span class="k">is</span> <span class="n">possible</span> <span class="k">for</span> <span class="n">now</span><span class="o">.</span>

<span class="n">algorithm</span><span class="o">:</span> <span class="n">AbstractString</span><span class="o">,</span> <span class="s2">&quot;KernelRidge&quot;</span> <span class="n">or</span> <span class="s2">&quot;SVM&quot;</span> <span class="n">or</span> <span class="s2">&quot;LinearRegression&quot;</span>
</pre></div>


<p>OPTIONS</p>
<div class="codehilite"><pre><span></span><span class="n">X_test</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">spectra</span> <span class="n">organised</span> <span class="k">in</span> <span class="n">rows</span> <span class="o">(</span><span class="mi">1</span> <span class="n">row</span> <span class="o">=</span> <span class="n">one</span> <span class="n">spectrum</span><span class="o">)</span> <span class="n">that</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span> <span class="k">as</span> <span class="n">a</span> <span class="n">testing</span> <span class="n">dataset</span><span class="o">.</span> <span class="n">THose</span> <span class="n">spectra</span> <span class="n">should</span> <span class="n">not</span> <span class="n">be</span> <span class="n">present</span> <span class="k">in</span> <span class="n">the</span> <span class="n">x</span> <span class="o">(</span><span class="n">training</span><span class="o">)</span> <span class="n">dataset</span><span class="o">.</span> <span class="n">The</span> <span class="n">spectra</span> <span class="n">should</span> <span class="n">share</span> <span class="n">a</span> <span class="n">common</span> <span class="n">X</span> <span class="n">axis</span><span class="o">;</span>

<span class="n">y_test</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">the</span> <span class="n">target</span> <span class="n">that</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span> <span class="k">as</span> <span class="n">a</span> <span class="n">testing</span> <span class="n">dataset</span><span class="o">.</span> <span class="n">Those</span> <span class="n">targets</span> <span class="n">should</span> <span class="n">not</span> <span class="n">be</span> <span class="n">present</span> <span class="k">in</span> <span class="n">the</span> <span class="n">y</span> <span class="o">(</span><span class="n">training</span><span class="o">)</span> <span class="n">dataset</span><span class="o">;</span>

<span class="n">scaler</span><span class="o">:</span> <span class="n">String</span><span class="o">,</span> <span class="n">the</span> <span class="n">type</span> <span class="n">of</span> <span class="n">scaling</span> <span class="n">performed</span><span class="o">.</span> <span class="n">Choose</span> <span class="n">between</span> <span class="n">MinMaxScaler</span> <span class="n">or</span> <span class="n">StandardScaler</span><span class="o">,</span> <span class="n">see</span> <span class="n">http</span><span class="o">://</span><span class="n">scikit</span><span class="o">-</span><span class="n">learn</span><span class="o">.</span><span class="na">org</span><span class="sr">/stable/modules/</span><span class="n">preprocessing</span><span class="o">.</span><span class="na">html</span> <span class="k">for</span> <span class="n">details</span><span class="o">.</span> <span class="n">Default</span> <span class="o">=</span> <span class="s2">&quot;MinMaxScaler&quot;</span><span class="o">;</span>

<span class="n">rand_state</span><span class="o">:</span> <span class="n">Float64</span><span class="o">,</span> <span class="n">the</span> <span class="n">random</span> <span class="n">seed</span> <span class="n">that</span> <span class="k">is</span> <span class="n">used</span> <span class="k">for</span> <span class="n">reproductibility</span> <span class="n">of</span> <span class="n">the</span> <span class="n">results</span><span class="o">.</span> <span class="n">Default</span> <span class="o">=</span> <span class="mi">42</span><span class="o">;</span>

<span class="n">param_grid_kr</span><span class="o">:</span> <span class="n">Dictionary</span><span class="o">,</span> <span class="n">containg</span> <span class="n">the</span> <span class="n">values</span> <span class="n">of</span> <span class="n">the</span> <span class="n">hyperparameters</span> <span class="n">that</span> <span class="n">should</span> <span class="n">be</span> <span class="n">checked</span> <span class="n">by</span> <span class="n">gridsearch</span> <span class="k">for</span> <span class="n">the</span> <span class="n">Kernel</span> <span class="n">Ridge</span> <span class="n">regression</span> <span class="n">algorithm</span><span class="o">;</span>

<span class="n">param_grid_svm</span><span class="o">:</span> <span class="n">Dictionary</span><span class="o">,</span> <span class="n">containg</span> <span class="n">the</span> <span class="n">values</span> <span class="n">of</span> <span class="n">the</span> <span class="n">hyperparameters</span> <span class="n">that</span> <span class="n">should</span> <span class="n">be</span> <span class="n">checked</span> <span class="n">by</span> <span class="n">gridsearch</span> <span class="k">for</span> <span class="n">the</span> <span class="n">Support</span> <span class="n">Vector</span> <span class="n">regression</span> <span class="n">algorithm</span><span class="o">.</span>
</pre></div>


<p>For the last two parameters, the user is refered to the documentation of SciKit Learn. See the pages:</p>
<p>http://scikit-learn.org/stable/modules/kernel_ridge.html</p>
<p>http://scikit-learn.org/stable/modules/generated/sklearn.svm.SVR.html</p>
<p>OUTPUTS</p>
<div class="codehilite"><pre><span></span><span class="n">prediction_train</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">the</span> <span class="n">predicted</span> <span class="n">target</span> <span class="n">values</span> <span class="k">for</span> <span class="n">the</span> <span class="n">training</span> <span class="n">y</span> <span class="n">dataset</span><span class="o">;</span>

<span class="n">prediction_test</span><span class="o">:</span> <span class="n">Array</span><span class="o">{</span><span class="n">Float64</span><span class="o">},</span> <span class="n">the</span> <span class="n">predicted</span> <span class="n">target</span> <span class="n">values</span> <span class="k">for</span> <span class="n">the</span> <span class="n">testing</span> <span class="n">y_test</span> <span class="n">dataset</span><span class="o">;</span>

<span class="n">model</span><span class="o">:</span> <span class="n">A</span> <span class="n">Scikit</span> <span class="n">Learn</span> <span class="n">object</span> <span class="n">model</span><span class="o">,</span> <span class="n">see</span> <span class="n">the</span> <span class="n">above</span> <span class="n">link</span> <span class="k">for</span> <span class="n">details</span><span class="o">;</span>

<span class="n">X_scaler</span><span class="o">:</span> <span class="n">A</span> <span class="n">Scikit</span> <span class="n">Learn</span> <span class="n">scaler</span> <span class="n">object</span> <span class="k">for</span> <span class="n">the</span> <span class="n">x</span> <span class="n">values</span><span class="o">;</span>

<span class="n">Y_scaler</span><span class="o">:</span> <span class="n">A</span> <span class="n">Scikit</span> <span class="n">Learn</span> <span class="n">scaler</span> <span class="n">object</span> <span class="k">for</span> <span class="n">the</span> <span class="n">y</span> <span class="n">values</span><span class="o">;</span>
</pre></div>


<p>NOTES </p>
<div class="codehilite"><pre><span></span>For Support Vector and Kernel Ridge regressions, mlregressor performs a cross_validation search with using 5 KFold cross validators. 

If the results are poor with Support Vector and Kernel Ridge regressions, you will have to tune the param_grid_kr or param_grid_svm dictionnary that records the hyperparameter space to investigate during the cross validation.
</pre></div>


<p><a target='_blank' href='https://github.com/charlesll/Spectra.jl/tree/41f6a9095c8184059cfb4fc29bfc08a81944e125/src/ml_regressor.jl#L14-L65' class='documenter-source'>source</a><br></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../PeakFitting/" class="btn btn-neutral float-right" title="Peak Fitting">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Rameau/" class="btn btn-neutral" title="Rameau"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/charlesll/Spectra.jl" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../Rameau/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../PeakFitting/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../assets/mathjaxhelper.js"></script>

</body>
</html>
