<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>General Functions · Spectra documentation</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Spectra documentation</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href="GeneralFunctions.html">General Functions</a><ul class="internal"><li><a class="toctext" href="#Peak-shapes-1">Peak shapes</a></li><li><a class="toctext" href="#Peak-measurement-1">Peak measurement</a></li><li><a class="toctext" href="#Integration-1">Integration</a></li><li><a class="toctext" href="#Polynomial-1">Polynomial</a></li></ul></li><li><a class="toctext" href="Installation.html">Installation</a></li><li><a class="toctext" href="MachineLearning.html">Machine Learning</a></li><li><a class="toctext" href="PeakFitting.html">Peak fitting</a></li><li><a class="toctext" href="PreProcessing.html">Pre-Processing</a></li><li><a class="toctext" href="References.html">References</a></li><li><a class="toctext" href="Tips.html">Tips</a></li><li><a class="toctext" href="index.html">Welcome to Spectra&#39;s documentation!</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="GeneralFunctions.html">General Functions</a></li></ul><a class="edit-page" href="https://github.com/charlesll/Spectra.jl/blob/master/docs/src/GeneralFunctions.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>General Functions</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="General-Functions-1" href="#General-Functions-1">General Functions</a></h1><h2><a class="nav-anchor" id="Peak-shapes-1" href="#Peak-shapes-1">Peak shapes</a></h2><p>The following functions are useful when generating peaks with various shapes. See the examples for using them during peak fitting for instance.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Spectra.gaussiennes" href="#Spectra.gaussiennes"><code>Spectra.gaussiennes</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">gaussiennes(amplitude::Array{Float64},centre::Array{Float64},hwhm::Array{Float64},x::Array{Float64};style::String = &quot;None&quot;)</code></pre><p>gaussiennes, written in the plural french form there, is a function that allows to build gaussian peaks. The gaussian function used there is:</p><pre><code class="language-none">y = amplitude x exp(-ln(2) x [(x-centre)/hwhm]^2 )</code></pre><p>You can enter the amplitude, centre and half-width at half-maximum (hwhm) values as arrays of float 64 (even containing one float value), without specifying style. hwhm is proportional to the standard deviation sigma:</p><pre><code class="language-none">hwhm= sqrt(2xln(2)) x sigma</code></pre><p>that is used in a normal distribution (see function normal_dist).</p><p><strong>Inputs</strong></p><pre><code class="language-none">amplitude: Array{Float64}
	peaks amplitudes
centre: Array{Float64}
	peaks centres
hwhm: Array{Float64}
	peaks half-width at middle heights (hwhm);
x: Array{Float64}
	x axis values;</code></pre><p><strong>Options</strong></p><pre><code class="language-none">style: ASCIIString = &quot;None&quot;
	see examples below.</code></pre><p><strong>Outputs</strong></p><pre><code class="language-none">y_calc: Array{Float64}
	calculated y values
y_peaks: Array{Float64}
	calculated y values of the different peaks.</code></pre><hr/><p><strong>Examples</strong></p><p>To have four gaussian peaks centered at 800, 900, 1000 and 1100 cm-1 with hwhm of 50 cm-1 on a Raman spectrum, you will enter:</p><pre><code class="language-none">```julia-repl
julia&gt; y_calc, y_peaks = gaussiennes([1.0,1.0,1.0,1.0], [800.0,900.0,1000.0,1100.0], [50.0,50.0,50.0,50.0], x)
```</code></pre><p>and y<em>peaks will contain in 4 columns the 4 different y values of the peaks, and y</em>calc their sum (the total model). Now, if you want to calculate more complex models, such as for instance contructing how the Raman peaks of water vary with pressure, you might like to parametrize the variations of the peak parameters rather than just fitting each spectrum. This will provide more robust fits of the spectra, as you will fit them together, and will also force you to find the correct underlying mathematical assumption.</p><p>The gaussiennes function allows you to do that. If you specify style = &quot;poly&quot;, you can enter arrays for the amplitudes, centres and half-widths at half-maximum (hwhm) of the peaks, with in each column the coefficients for the polynomial variations of this parameters. The second column of x will need to contain the second variable for those polynomial functions.</p><p>Let&#39;s say for instance that we have one peak at 900 cm-1 in a pure material. It&#39;s frequency seems to linearly shift with increasing the amount of hydrogen in this material, but it&#39;s intensity is non-linearly increasing, following a quadratic variation. It&#39;s width seems constant.</p><p>How to write that with gaussiennes? Well, first you need to construct a relevant x axis: first column contains the frequency, and the second one contains the chemical variable value. In our case, we want to model the peak between 800 and 1000 cm-1, for 1 wt% H. So we have an x array build like:</p><pre><code class="language-none">```julia-repl
julia&gt; frequency = collect(800:1:1000)
julia&gt; x = ones(length(frequency),2)
julia&gt; x[:,1] = frequency[:]
julia&gt; x[:,2] = 1.0
```</code></pre><p>Ok, now lets build our y peaks:</p><pre><code class="language-none">```julia-repl
julia&gt; amplitudes = [1.0 0.1 0.1]
julia&gt; frequencies = [900.0 2.0]
julia&gt; hwhm = 20.0
julia&gt; y_calc, y_peaks = gaussiennes(amplitudes, frequencies, hwhm, x)
```</code></pre><p>This should provide you how the shape of the peak is as a function of both the frequency and the chemical composition there. If you want to go further, you might just want to stick gaussiennes in a loop, and play with creating various peaks with changing the chemical parameter in the x[:,2] column!</p></div></div><a class="source-link" target="_blank" href="https://github.com/charlesll/Spectra.jl/blob/12b9a31ad0ce6146b731ad00c875476261b309d2/src/functions.jl#L42-L116">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Spectra.lorentziennes" href="#Spectra.lorentziennes"><code>Spectra.lorentziennes</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">lorentziennes(amplitude::Array{Float64},centre::Array{Float64},hwhm::Array{Float64},x::Array{Float64};style::String = &quot;None&quot;)</code></pre><p><strong>Inputs</strong></p><pre><code class="language-none">amplitude: Array{Float64}
	peaks amplitudes
centre: Array{Float64}
	peaks centres
hwhm: Array{Float64}
	peaks half-width at middle heights (hwhm)
x: Array{Float64}
	x axis values</code></pre><p><strong>Options</strong></p><pre><code class="language-none">style: ASCIIString = &quot;None&quot;, see examples in the gaussiennes documentation.</code></pre><p><strong>Outputs</strong></p><pre><code class="language-none">y_calc: Array{Float64}
	calculated y values
y_peaks: Array{Float64}
	calculated y values of the different peaks.</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/charlesll/Spectra.jl/blob/12b9a31ad0ce6146b731ad00c875476261b309d2/src/functions.jl#L133-L161">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Spectra.pearson7" href="#Spectra.pearson7"><code>Spectra.pearson7</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">pearson7(a1::Array{Float64},a2::Array{Float64},a3::Array{Float64},a4::Array{Float64},x::Array{Float64};style::String = &quot;None&quot;)</code></pre><p>a Pearson 7 peak with formula a1 ./ (1 + ((x-a2)./a3).^2 .* (2.0.^(1./a4) - 1.0))</p><p><strong>Inputs</strong></p><pre><code class="language-none">a1: Array{Float64}
	parameter a1
a2: Array{Float64}
	parameter a2
a3: Array{Float64}
	parameter a3
a4: Array{Float64}
	parameter a4
x: Array{Float64}
	x axis values</code></pre><p><strong>Options</strong></p><pre><code class="language-none">style: ASCIIString = &quot;None&quot;, see examples in the gaussiennes documentation.</code></pre><p><strong>Outputs</strong></p><pre><code class="language-none">y_calc: Array{Float64}
	calculated y values
y_peaks: Array{Float64}
	y values of the different peaks.</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/charlesll/Spectra.jl/blob/12b9a31ad0ce6146b731ad00c875476261b309d2/src/functions.jl#L178-L210">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Spectra.pseudovoigts" href="#Spectra.pseudovoigts"><code>Spectra.pseudovoigts</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">pseudovoigts(amplitude::Array{Float64},centre::Array{Float64},hwhm::Array{Float64},lorentzian_fraction::Array{Float64},x::Array{Float64};style::String = &quot;None&quot;)</code></pre><p>A mixture of gaussian and lorentzian peaks.</p><p><strong>Inputs</strong></p><pre><code class="language-none">amplitude: Array{Float64}
	peaks amplitudes
centre: Array{Float64}
	peaks centres
hwhm: Array{Float64}
	peaks half-width at middle heights (hwhm)
lorentzian_fraction: Array{Float64}
	lorentzian fraction of the pseudovoigt function. Should be comprised between 0 and 1;
x: Array{Float64}
	x axis values</code></pre><p><strong>Options</strong></p><pre><code class="language-none">style: ASCIIString = &quot;None&quot;, see examples in the gaussiennes documentation.</code></pre><p><strong>Outputs</strong></p><pre><code class="language-none">y_calc: Array{Float64}
	calculated y values
y_peaks: Array{Float64}
	y values of the different peaks</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/charlesll/Spectra.jl/blob/12b9a31ad0ce6146b731ad00c875476261b309d2/src/functions.jl#L227-L256">source</a></section><h2><a class="nav-anchor" id="Peak-measurement-1" href="#Peak-measurement-1">Peak measurement</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Spectra.peakmeas" href="#Spectra.peakmeas"><code>Spectra.peakmeas</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">peakmeas(x::Array{Float64,1}, y::Array{Float64,1}; smoothing = &quot;yes&quot;, method = &quot;savgol&quot;, window_length=5, polyorder=2, ese_y=1., y_smo_out=false)</code></pre><p>The peakmeas function allows performing measurements of the position, width, intensity and centroïd of a dominant peak in a provided x-y signal.</p><p>It smooths the signal with a Savitzky-Golay filter prior to measuring the peak position, width and intensity. It is advised to check that the M and N values of the Savitzky-Golay filter are adequate for your problem before trusting the results from peakmeas. For that, just use the y<em>smo</em>out option.</p><p>half-width at half-maximum are calculated as the width of the peak at half its maximum intensity. This calculation is not affected by any asumption of peak symmetry (no fitting is done).</p><p>Centroïd is calculated as sum(y./sum(y).*x).</p><p><strong>Inputs</strong></p><pre><code class="language-none">x: Array{Float64}
	x values
y: Array{Float64}
	y values</code></pre><p><strong>Options</strong></p><pre><code class="language-none">smoothing, String
	triggers the smoothing of the spectrum if set to yes (default value);
filter, Symbol
	the filter that will be used. See the smooth function documentation;
M=5, Int
	M parameter for smoothing y with a Savitzky-Golay filter. See smooth function documentation;
N=2, Int
	M parameter for smoothing y with a Savitzky-Golay filter. See smooth function documentation;
y_smo_out=false
	Outputs the smoothed signal.</code></pre><p><strong>Outputs</strong></p><pre><code class="language-none">intensity: Float64
	peak intensity
position: Float64
	peak position
hwhm: Float64
 	peak half-width at half-maximum
centroïd: Float64
 	peak centroid</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/charlesll/Spectra.jl/blob/12b9a31ad0ce6146b731ad00c875476261b309d2/src/peakmeasurement.jl#L17-L59">source</a></section><h2><a class="nav-anchor" id="Integration-1" href="#Integration-1">Integration</a></h2><p>Spectra.jl provides functions that allow one to integrate the area under a region of a spectrum, or to calculate the area under Gaussian, Lorentzian or other bands.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Spectra.trapz" href="#Spectra.trapz"><code>Spectra.trapz</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">trapz(x::Vector{Tx}, y::Vector{Ty}) where {Tx &lt;: Number, Ty &lt;: Number}</code></pre><p>Trapezoidal integration. This function is particularly helpful to calculate the area under a portion of a spectrum, and can be used for various purposes (normalisation, area comparison, etc.).</p><p><strong>Inputs</strong></p><pre><code class="language-none">x: Vector{Float64}
	x values
y: Vector{Float64}
	y values.</code></pre><p><strong>Outputs</strong></p><pre><code class="language-none">area: Vector{Float64}
	trapezoidal integration value.</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/charlesll/Spectra.jl/blob/12b9a31ad0ce6146b731ad00c875476261b309d2/src/integrale.jl#L17-L35">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Spectra.bandarea" href="#Spectra.bandarea"><code>Spectra.bandarea</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">bandarea(Amplitude::Array{Float64},HWHM::Array{Float64}; peak_shape = &quot;Gaussian&quot;, error_switch = &quot;no&quot;, eseAmplitude::Array{Float64} = [0.0], eseHWHM::Array{Float64} = [0.0])</code></pre><p>This function allows calculating the area under a specific band, with different shapes. For now, only Gaussian bands are supported, but other band shapes will be added soon.</p><p><strong>Inputs</strong></p><pre><code class="language-none">Amplitude: Array{Float64}
	peak amplitude
HWHM: Array{Float64}
	peak half width at half maximum</code></pre><p><strong>Options</strong></p><pre><code class="language-none">peak_shape: String
	shape of the peak. Only &quot;Gaussian&quot; is supported for now
error_switch: String
	should be &quot;yes&quot; or &quot;no&quot;. If &quot;yes&quot;, the arrays containing the errors affecting the band amplitude and widhts should be provided in eseAmplitude and eseHWHM (see below);
eseAmplitude: Array{Float64}
	array containing the errors affecting Amplitude
eseHWHM: Array{Float64}
	array containing the errors affecting HWHM;</code></pre><p><strong>Outputs</strong></p><pre><code class="language-none">area: Array{Float64}
	array containing peak areas

if error_switch is set to &quot;yes&quot;, then a second output is provided:

esearea: Array{Float64}
	array that contains the propagated errors affecting the areas calculations.</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/charlesll/Spectra.jl/blob/12b9a31ad0ce6146b731ad00c875476261b309d2/src/integrale.jl#L51-L86">source</a></section><h2><a class="nav-anchor" id="Polynomial-1" href="#Polynomial-1">Polynomial</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Spectra.poly" href="#Spectra.poly"><code>Spectra.poly</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">poly(p::Vector{Float64},x::Array{Float64})</code></pre><p>This function just allows to build a polynomial curve.</p><p><strong>Inputs</strong></p><pre><code class="language-none">p: Vector{Float64}
	polynomial parameters. For a linear curve, p = [1.0,1.0], for a second order polynomial, p = [1.0,1.0,1.0], etc.;
x: Array{Float64}
	x values for calculation.</code></pre><p><strong>Outputs</strong></p><pre><code class="language-none">y: Array{Float64}, containing the result of calculation.</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/charlesll/Spectra.jl/blob/12b9a31ad0ce6146b731ad00c875476261b309d2/src/functions.jl#L16-L33">source</a></section><footer><hr/><a class="next" href="Installation.html"><span class="direction">Next</span><span class="title">Installation</span></a></footer></article></body></html>
